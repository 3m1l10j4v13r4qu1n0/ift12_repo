@startuml moduloGestionUsuarios
title M1: Módulo de Gestión de Usuarios (Detallado)

left to right direction
skinparam packageStyle rectangle

' ===== ESTILOS VISUALES =====
skinparam usecase {
    BackgroundColor White
    BorderColor Black
    BorderThickness 2
}

skinparam actor {
    BackgroundColor White
    BorderColor Black
    BorderThickness 2
}

skinparam package {
    BorderThickness 2
    FontStyle bold
}

' ===== ACTORES =====
actor "Pareja\n<<abstract>>" as Pareja #LightGray
actor "Novia" as SoyNovia #Pink
actor "Novio" as SoyNovio #LightBlue
actor "Invitado" as Invitado #Wheat
actor "Sistema de\nCorreo" as Mail <<external>> #LightCyan

' Generalización
SoyNovia -up-|> Pareja
SoyNovio -up-|> Pareja

' ===== CASOS DE USO PRINCIPALES =====
package "Gestión de Usuarios - Principal" #LightYellow {
  usecase UC01 as "Registrar usuario"
  usecase UC02 as "Iniciar sesión"
  usecase UC03 as "Gestionar perfil"
  usecase UC04 as "Recuperar contraseña"
  usecase UC05 as "Cerrar sesión"
}

' ===== SUBMÓDULO: REGISTRO DE PAREJAS =====
package "Registro de Parejas" #MistyRose {
  usecase UC01a as "Registrar como Pareja"
  usecase UC01b as "Seleccionar Rol\n(Novia/Novio)"
  usecase UC01c as "Generar Código\nde Vinculación"
  usecase UC01d as "Vincular Integrante"
  usecase UC01e as "Verificar Código\nde Pareja"
  usecase UC01f as "Confirmar Vinculación\npor Correo"
  usecase UC01g as "Completar Perfil\nde Pareja"
}

' ===== SUBMÓDULO: REGISTRO DE INVITADOS =====
package "Registro de Invitados" #Honeydew {
  usecase UC01h as "Registrar como\nInvitado"
  usecase UC01i as "Asignar Rol Invitado"
  usecase UC01j as "Verificar Correo\nInvitado"
  usecase UC01k as "Configurar\nPreferencias"
}

' ===== SUBMÓDULO: VALIDACIONES =====
package "Validaciones y Seguridad" #AliceBlue {
  usecase UC01m as "Validar Datos\nde Registro"
  usecase UC01n as "Verificar Usuario\nNo Existente"
  usecase UC01o as "Encriptar Contraseña"
  usecase UC01p as "Enviar Correo\nde Verificación"
}

' ===== RELACIONES DE ACTORES =====
Pareja --> UC01
Pareja --> UC02
Pareja --> UC03
Pareja --> UC04
Pareja --> UC05

Invitado --> UC01
Invitado --> UC02
Invitado --> UC03
Invitado --> UC04
Invitado --> UC05

Mail --> UC01f
Mail --> UC01j
Mail --> UC01p

' ===== RELACIONES ENTRE CASOS DE USO =====

' Flujo Principal
UC01 ..> UC01m : <<include>>
UC01 ..> UC01n : <<include>>
UC01 ..> UC01a : <<extend>>\n[es pareja]
UC01 ..> UC01h : <<extend>>\n[es invitado]
UC01 ..> UC02 : <<extend>>\n[post-verificación]

UC03 ..> UC02 : <<precondition>>
UC04 ..> UC01p : <<include>>

' Flujo Parejas
UC01a ..> UC01b : <<include>>
UC01a ..> UC01o : <<include>>
UC01b ..> UC01c : <<include>>\n[primer integrante]
UC01b ..> UC01d : <<extend>>\n[segundo integrante]
UC01d ..> UC01e : <<include>>
UC01e ..> UC01f : <<include>>
UC01f ..> UC01g : <<include>>
UC01g ..> UC01p : <<include>>

' Flujo Invitados
UC01h ..> UC01i : <<include>>
UC01h ..> UC01o : <<include>>
UC01i ..> UC01j : <<include>>
UC01j ..> UC01k : <<extend>>

' ===== NOTAS =====
note right of UC01a
  **Flujo Primer Integrante:**
  1. Selecciona rol (Novia/Novio)
  2. Completa datos personales
  3. Sistema genera código único
  4. Comparte código con pareja
end note

note right of UC01d
  **Flujo Segundo Integrante:**
  1. Ingresa código de vinculación
  2. Selecciona su rol
  3. Sistema valida el código
  4. Ambos reciben email
  5. Completan perfil conjunto
end note

note bottom of UC01m
  **Validaciones incluyen:**
  • Email válido y único
  • Contraseña segura (8+ chars)
  • Campos obligatorios
  • Términos y condiciones
  • Captcha anti-bot
end note

@enduml