@startuml moduloNotificaciones
title M6: MÃ³dulo de Notificaciones (Detallado)

left to right direction
skinparam packageStyle rectangle

' ===== ESTILOS VISUALES =====
skinparam usecase {
    BackgroundColor White
    BorderColor Black
    BorderThickness 2
}

skinparam actor {
    BackgroundColor White
    BorderColor Black
    BorderThickness 2
}

skinparam package {
    BorderThickness 2
    FontStyle bold
}

' ===== ACTORES =====
actor "Pareja\n<<abstract>>" as Pareja #LightGray
actor "Novia" as SoyNovia #Pink
actor "Novio" as SoyNovio #LightBlue
actor "Invitado" as Invitado #Wheat
actor "Sistema de\nCorreo" as Mail <<external>> #LightCyan

' GeneralizaciÃ³n
SoyNovia -up-|> Pareja
SoyNovio -up-|> Pareja

' ===== CASOS DE USO PRINCIPALES =====
package "Notificaciones - Principal" #LightPink {
  usecase UC50 as "Enviar notificaciones"
  usecase UC51 as "Gestionar preferencias\nde notificaciÃ³n"
  usecase UC52 as "Ver historial\nde notificaciones"
}

' ===== SUBMÃ“DULO: NOTIFICACIONES A PAREJA =====
package "Notificaciones a Pareja" #MistyRose {
  usecase UC50a as "Notificar nueva compra"
  usecase UC50b as "Notificar mensaje\nde invitado"
  usecase UC50c as "Notificar producto\ncompleto"
  usecase UC50d as "Notificar lista completa"
  usecase UC50e as "Resumen diario\nde actividad"
  usecase UC50f as "Resumen semanal"
  usecase UC50g as "Alerta de hito\nalcanzado"
}

' ===== SUBMÃ“DULO: NOTIFICACIONES A INVITADO =====
package "Notificaciones a Invitado" #LavenderBlush {
  usecase UC51a as "ConfirmaciÃ³n de compra"
  usecase UC51b as "Comprobante de pago"
  usecase UC51c as "Agradecimiento\nde la pareja"
  usecase UC51d as "Recordatorio de\nreserva pendiente"
  usecase UC51e as "Notificar pago\npendiente"
  usecase UC51f as "ActualizaciÃ³n\nde lista"
  usecase UC51g as "InvitaciÃ³n a evento"
}

' ===== SUBMÃ“DULO: CANALES DE COMUNICACIÃ“N =====
package "Canales de ComunicaciÃ³n" #Pink {
  usecase UC52a as "Email"
  usecase UC52b as "NotificaciÃ³n push\n(web/mÃ³vil)"
  usecase UC52c as "SMS"
  usecase UC52d as "WhatsApp"
  usecase UC52e as "NotificaciÃ³n in-app"
  usecase UC52f as "Webhook a sistemas\nexternos"
}

' ===== SUBMÃ“DULO: TIPOS DE NOTIFICACIÃ“N =====
package "Tipos de NotificaciÃ³n" #HotPink {
  usecase UC53a as "Transaccionales\n(compra, pago)"
  usecase UC53b as "Informativas\n(resÃºmenes, alertas)"
  usecase UC53c as "Promocionales\n(sugerencias, ofertas)"
  usecase UC53d as "Recordatorios\n(fechas, pendientes)"
  usecase UC53e as "Urgentes\n(problemas, errores)"
  usecase UC53f as "Sociales\n(mensajes, felicitaciones)"
}

' ===== SUBMÃ“DULO: CONFIGURACIÃ“N =====
package "ConfiguraciÃ³n de Preferencias" #LightCoral {
  usecase UC54a as "Activar/desactivar\nnotificaciones"
  usecase UC54b as "Seleccionar canales\npreferidos"
  usecase UC54c as "Configurar frecuencia"
  usecase UC54d as "Establecer horarios"
  usecase UC54e as "Filtrar por tipo"
  usecase UC54f as "Modo silencioso\ntemporal"
  usecase UC54g as "Configurar idioma"
}

' ===== SUBMÃ“DULO: PLANTILLAS =====
package "GestiÃ³n de Plantillas" #Salmon {
  usecase UC55a as "Plantillas de email"
  usecase UC55b as "Plantillas de SMS"
  usecase UC55c as "Personalizar mensajes"
  usecase UC55d as "Variables dinÃ¡micas"
  usecase UC55e as "DiseÃ±o responsive"
  usecase UC55f as "Vista previa\nde plantilla"
  usecase UC55g as "Historial de versiones"
}

' ===== RELACIONES DE ACTORES =====
Pareja --> UC50
Pareja --> UC51
Pareja --> UC52

Invitado --> UC51
Invitado --> UC52

Mail --> UC52a

' ===== RELACIONES ENTRE CASOS DE USO =====

' Flujo Principal
UC50 ..> UC52a : <<default>>
UC50 ..> UC52b : <<extend>>
UC50 ..> UC52c : <<extend>>
UC50 ..> UC52d : <<extend>>
UC50 ..> UC52e : <<include>>

UC50 ..> UC53a : <<type>>
UC50 ..> UC53b : <<type>>
UC50 ..> UC53c : <<type>>
UC50 ..> UC53d : <<type>>
UC50 ..> UC53e : <<type>>
UC50 ..> UC53f : <<type>>

' Flujo Notificaciones Pareja
UC50a ..> UC50 : <<uses>>
UC50b ..> UC50 : <<uses>>
UC50c ..> UC50 : <<uses>>
UC50d ..> UC50 : <<uses>>
UC50e ..> UC50 : <<uses>>
UC50f ..> UC50 : <<uses>>
UC50g ..> UC50 : <<uses>>

UC50e ..> UC50a : <<aggregates>>
UC50f ..> UC50e : <<aggregates>>

' Flujo Notificaciones Invitado
UC51a ..> UC50 : <<uses>>
UC51b ..> UC50 : <<uses>>
UC51c ..> UC50 : <<uses>>
UC51d ..> UC50 : <<uses>>
UC51e ..> UC50 : <<uses>>
UC51f ..> UC50 : <<uses>>
UC51g ..> UC50 : <<uses>>

' Flujo ConfiguraciÃ³n
UC51 ..> UC54a : <<include>>
UC51 ..> UC54b : <<include>>
UC51 ..> UC54c : <<extend>>
UC51 ..> UC54d : <<extend>>
UC51 ..> UC54e : <<extend>>
UC51 ..> UC54f : <<extend>>
UC51 ..> UC54g : <<extend>>

UC54b ..> UC52a : <<configures>>
UC54b ..> UC52b : <<configures>>
UC54b ..> UC52c : <<configures>>
UC54b ..> UC52d : <<configures>>

' Flujo Plantillas
UC55a ..> UC52a : <<uses>>
UC55b ..> UC52c : <<uses>>
UC55c ..> UC55a : <<extends>>
UC55c ..> UC55b : <<extends>>
UC55d ..> UC55c : <<include>>
UC55e ..> UC55a : <<include>>
UC55f ..> UC55a : <<include>>

' ===== NOTAS =====
note right of UC50a
  **NotificaciÃ³n de compra incluye:**
  
  â€¢ Producto(s) comprado(s)
  â€¢ Nombre del invitado (si no es anÃ³nimo)
  â€¢ Mensaje personalizado
  â€¢ Monto pagado
  â€¢ Fecha y hora
  â€¢ Estado de la lista actualizado
  
  Se envÃ­a inmediatamente
  despuÃ©s de confirmar el pago
end note

note right of UC50e
  **Resumen diario:**
  
  Enviado a las 20:00 hs
  Solo si hay actividad del dÃ­a
  
  Incluye:
  â€¢ Nuevas compras
  â€¢ Mensajes recibidos
  â€¢ Visitas a la lista
  â€¢ Productos completados
  â€¢ Progreso de la lista
end note

note bottom of UC52a
  **Canales disponibles:**
  
  ðŸ“§ **Email**: Principal, siempre activo
  ðŸ”” **Push**: Requiere permiso del navegador
  ðŸ“± **SMS**: Solo para notificaciones crÃ­ticas
  ðŸ’š **WhatsApp**: IntegraciÃ³n opcional
  ðŸ”„ **In-app**: Dentro de la aplicaciÃ³n
  ðŸ”— **Webhook**: Para integraciones
end note

note bottom of UC54c
  **Frecuencias:**
  
  â€¢ **Inmediata**: Cada evento
  â€¢ **Agrupada**: Cada hora
  â€¢ **Diaria**: Resumen 1 vez/dÃ­a
  â€¢ **Semanal**: Resumen semanal
  â€¢ **Solo crÃ­ticas**: Urgentes Ãºnicamente
  â€¢ **Desactivadas**: Sin notificaciones
end note

note bottom of UC55d
  **Variables dinÃ¡micas:**
  
  {nombre_pareja}
  {nombre_invitado}
  {producto}
  {monto}
  {fecha_boda}
  {link_lista}
  {mensaje_personalizado}
  {progreso_porcentaje}
  
  Se reemplazan automÃ¡ticamente
  al enviar la notificaciÃ³n
end note

@enduml